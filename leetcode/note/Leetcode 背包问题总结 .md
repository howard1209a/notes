---
title: 背包问题总结
date: 2023-11-11 10:34:23
tags: [Leetcode总结]
---

# 背包问题总结

## 01 背包

### 01 背包标准模型

给定一些物品和一个背包，每个物品有重量和价值（都是正整数），背包有容量（自然数），尽可能地往背包中装物品（每个物品可以装也可以不装），问最大价值。其实等价于所有物品子集中满足背包容量条件的最大价值。

解法是动态规划，$dp[i][j]$代表 0-i 号物品随便装，背包容量为 j 的最大价值，递推公式是如果 i 号物品重量大于背包容量 j，则$dp[i][j]=dp[i-1][j]$，如果背包容量 j 可以装下 i 号物品，则需要分类讨论装 i 号物品的情况和不装 i 号物品的情况，即$dp[i][j]=max(dp[i-1][j],dp[i-1][j-weight[i]]+value[i])$。

初始化第一行即可，如果是二维数组 dp，那么接下来每一行从前往后遍历即可，如果是滚动数组的话，每一次都要从后往前遍历。

用二维数组做 dp：

- 时间复杂度$O(n*m)$，其中 n 为物品个数，m 为背包容量
- 空间复杂度$O(n*m)$

用滚动数组做 dp：

- 时间复杂度$O(n*m)$，其中 n 为物品个数，m 为背包容量
- 空间复杂度$O(m)$

### 最多能装多少模型

给定背包容量，尽可能装，最多能装多少。定义所有物品的价值等于物品的重量，再套 01 背包标准模型，问题转化为了背包容量限制下尽可能装，最多能装多重。

力扣题目链接：[https://leetcode.cn/problems/last-stone-weight-ii/](https://leetcode.cn/problems/last-stone-weight-ii/)

### 恰巧装满有多少种情况模型

给定背包容量，装满背包有多少种方法。

前面两种模型的数组下标含义是一样的，本模型的数组下标含义变成了：$dp[i][j]$代表 0-i 号物品随便装，背包容量为 j ，恰巧装满一共有多少种情况。递推公式是如果 i 号物品重量大于背包容量 j，则$dp[i][j]=dp[i-1][j]$，如果背包容量 j 可以装下 i 号物品，则需要分类讨论装 i 号物品的情况和不装 i 号物品的情况，即$dp[i][j]=dp[i-1][j]+dp[i-1][j-weight[i]]$。

初始化第一行即可，如果是二维数组 dp，那么接下来每一行从前往后遍历即可，如果是滚动数组的话，每一次都要从后往前遍历。

力扣题目链接：[https://leetcode.cn/problems/target-sum/](https://leetcode.cn/problems/target-sum/)

### 能否装满模型

等价于最多能装多少模型中求出来的“最多”是否等于装满

等价于恰巧装满有多少种情况模型中情况数>0

力扣题目链接：[https://leetcode.cn/problems/partition-equal-subset-sum/](https://leetcode.cn/problems/partition-equal-subset-sum/)

### 最多能装多少个物品模型

给定背包容量，最多能装多少个物品

定义所有物品的价值都等于 1，然后套 01 背包标准模型即可，最大价值即最多数目。

当背包有两个维度的容量限制的时候就要麻烦一点，需要使用三维 dp。

力扣题目链接：[https://leetcode.cn/problems/ones-and-zeroes/](https://leetcode.cn/problems/ones-and-zeroes/)

## 完全背包

### 完全背包标准模型

给定一些物品和一个背包，每个物品有重量和价值（都是正整数），背包有容量（自然数），尽可能地往背包中装物品（每个物品可以装 0 到多次），问最大价值。

解法是动态规划，$dp[i][j]$代表 0-i 号物品随便装（每个物品可以装 0 到多次），背包容量为 j 的最大价值，递推公式是如果 i 号物品重量大于背包容量 j，则$dp[i][j]=dp[i-1][j]$，如果背包容量 j 可以装下 i 号物品，则需要分类讨论不装 i 号物品的情况和至少装一个 i 号物品的情况，即$dp[i][j]=max(dp[i-1][j],dp[i][j-weight[i]]+value[i])$。

初始化第一行即可，如果是二维数组 dp，那么接下来每一行从前往后遍历即可，如果是滚动数组的话，每一次都要从前往后遍历。

为什么 01 背包标准模型和完全背包标准模型的滚动数组遍历顺序不同呢？因为递推公式的区别。

用二维数组做 dp：

- 时间复杂度$O(n*m)$，其中 n 为物品个数，m 为背包容量
- 空间复杂度$O(n*m)$

用滚动数组做 dp：

- 时间复杂度$O(n*m)$，其中 n 为物品个数，m 为背包容量
- 空间复杂度$O(m)$

### 恰巧装满有多少种情况模型（组合）

和 01 背包标准模型迁移到 01 背包恰巧装满有多少种情况模型是一样的。

只不过由于是完全背包所以分类讨论变成了不装 i 号物品的情况和至少装一个 i 号物品的情况。

力扣题目链接：[https://leetcode.cn/problems/coin-change-ii/](https://leetcode.cn/problems/coin-change-ii/)

### 恰巧装满有多少种情况模型（排列）

和之前的模型都不一样，属于完全的一维 dp。

dp 数组下标含义是：$dp[i]$代表所有物品随便装（每个物品可以装 0 到多次），背包容量为 i ，恰好装满的排列情况数。

递推公式中的分类讨论变成了，排列序列的最后一个物品是什么。

初始化 dp[0]即可，然后从前向后遍历。

力扣题目链接：[https://leetcode.cn/problems/combination-sum-iv/](https://leetcode.cn/problems/combination-sum-iv/)

### 恰好装满所需最少物品数

$dp[i][j]$代表 0-i 号物品随便装（每个物品可以装 0 到多次），背包容量为 j ，恰好装满所需最少物品数。

接下来和完全背包标准模型基本一样，值得一提的是我们可以用-1 或 Integer.MAXVULE 代表 dp[i][j]无法恰好装满。

力扣题目链接：[https://leetcode.cn/problems/perfect-squares/](https://leetcode.cn/problems/perfect-squares/)

力扣题目链接：[https://leetcode.cn/problems/coin-change/](https://leetcode.cn/problems/coin-change/)

## 多重背包

每个物品仍然可以取 0 到多，但是每个物品可取的数目是有上界的。

转换成 01 背包即可。

## 自检

以下写法是否都掌握了：

- 01 背包最大价值问题的二维 dp 和一维 dp
- 01 背包恰好装满有多少种情形问题的二维 dp 和一维 dp
- 完全背包最大价值问题的二维 dp 和一维 dp
- 完全背包恰好装满有多少种情形（组合）问题的二维 dp 和一维 dp
- 完全背包恰好装满有多少种情形（排列）问题的特殊 dp
