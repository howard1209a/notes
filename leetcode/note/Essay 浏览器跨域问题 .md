---
title: 浏览器跨域问题
date: 2023-11-24 11:09:49
tags: [计算机网络, 八股文]
---

# 浏览器跨域问题

## 什么是跨域

只要满足如下一条不同就存在跨域：

- 协议不同
- 域名不同
- 端口不同

浏览器限制当前页面不可以跨域获取浏览器缓存 cookie，不可以跨域发送 ajax 请求。跨域限制主要是为了用户的信息安全。

## 浏览器如何判断跨域

跨域 ajax 请求的判断流程为：

- 如果该请求为简单请求，浏览器会直接发送实际请求到服务端，浏览器会根据服务端的响应，判断该请求是否可以跨域。如果不能跨域，浏览器会报错，阻止 JS 代码进一步执行。如果能够跨域，则 JS 能正常处理响应，进行后续业务流程。
- 如果该请求为非简单请求，浏览器会先发送一个预检请求(preflight)，方法为 OPTIONS，然后针对服务器的响应，做上述跟简单请求一样相同的判断：如果不能跨域，则实际请求不会发送。如果能够跨域，则实际请求会进行发送，进行后续业务处理。

值得说明的是，浏览器在跨域的情况下，请求都会发送出去，但是对于响应会判断是否满足跨域条件，如果不满足，则报错，阻止 JS 后续的执行流程，例如读取响应数据等。也就是说，跨域机制主要是阻止数据的跨域获取，不是阻止请求的发送。

服务端 http 响应分组中的 Access-Control-Allow-Origin 决定了此跨域请求是否被服务端允许，字段值可以填 *（通配符）或者单域名。*代表服务端允许任意跨域请求，单域名代表服务端允许来自此域名的跨域请求。

## 参考资料

https://zhuanlan.zhihu.com/p/159060398
