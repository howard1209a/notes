---
title: 无队列、阻塞队列和消息队列
date: 2023-10-29 13:30:23
tags: [Java, 八股文]
---

# 无队列、阻塞队列和消息队列

### 无队列

无队列的情况意味着任务生成后要在当前线程立即执行，有多少个并发就要同时执行多少个任务，假设同一时间有 1000 个并发，那么就要同时执行 1000 个任务，导致计算负载太大。另一个缺点是对于某些请求，生成任务后丢到队列中然后直接返回可以提高响应速度以及并发能力。

### 阻塞队列

阻塞队列取数据若队空会阻塞，存数据若队慢会阻塞。比如 Java 中 concurrent 包的 ArrayBlockingQueue，就是一个数组实现的线程安全阻塞队列。阻塞队列相比于无队列的优点是：第一，任务生成与任务消费解耦。第二，无论请求并发是多少，任务消费始终以可控的速度执行。

### 消息队列

消息队列相比于阻塞队列功能更加强大。主要优点有：第一，以独立服务的方式运行，不占用 JVM 内存，不会导致 JVM 堆内存溢出。第二，有持久化技术，若服务宕机消息数据仍存在。第三，消息数据只有在确认被消费后才会被清除，这意味着消费者取出数据后的消费出现异常时消息队列中的数据不会丢失。
